{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "properties": {
        "messageInformation": {
            "$ref": "#/$defs/messageInformation"
        },
        "producer": {
            "type": "object",
            "properties": {
                "firstName": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 105,
                    "pattern": "(^[a-zA-Z0-9=()=*@#\\s.,'_/~%$!();:&amp;&quot;+&#x00ae;`\\-\\?\"=]{1,105}$)",
                    "description": "This is the first name of the producer."
                },
                "lastName": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 105,
                    "pattern": "(^[a-zA-Z0-9=()=*@#\\s.,'_/~%$!();:&amp;&quot;+&#x00ae;`\\-\\?\"=]{1,105}$)",
                    "description": "This is the last name of the producer."
                },
                "npn": {
                    "type": "string",
                    "minLength": 5,
                    "maxLength": 10,
                    "description": "The National Producer Number (NPN) assigned by NIPR to identifiy the financial professional."
                },
                "crd": {
                    "type": "string",
                    "minLength": 5,
                    "maxLength": 10,
                    "description": "The Central Registration Depository (CRD) number assigned by FINRA to identify the financial professional."
                },
                "ssn": {
                    "type": "string",
                    "minLength": 9,
                    "maxLength": 9,
                    "description": "The unique nine-digit identifier issued by the U.S. Social Security Administration (SSA) to identify the financial professional."
                }
            },
            "additionalProperties": false,
            "required": [
                "firstName",
                "lastName",
               ],
			"anyOf": [
				{
					"required": [ "npn" ]
				},
				{
					"required": [ "crd" ]
				}
			]
		},
        "courseInformationList": {
            "type": "array",
            "items": {
                "$ref": "#/$defs/courseInformation"
            },
            "minItems": 1,
            "maxItems": 12
        }
    },
    "required": [
        "messageInformation",
        "producer",
        "courseInformationList"
    ],
    "propertyNames": {
        "enum": [
            "messageInformation",
            "producer",
            "courseInformationList"
        ]
    },
    "$defs": {
        "messageInformation": {
            "type": "object",
            "description": "The Message Information Resource is designed to provide all the information about a message.",
            "properties": {
                "messageType": {
                    "type": "string",
                    "enum": [
                        "PTU"
                    ],
                    "description": "This identifies the type of message being submitted in this message."
                },
                "sender": {
                    "type": "string",
                    "minLength": 8,
                    "maxLength": 8,
                    "description": "This identifies the originator this message."
                },
                "receiver": {
                    "type": "string",
                    "minLength": 8,
                    "maxLength": 8,
                    "description": "This identifies the receiver of this API message."
                },
                "trackingNumber": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 65,
                    "description": "This is an unique alphanumeric value used to identify a specific transaction."
                }
            },
            "additionalProperties": false,
            "required": [
                "messageType",
                "sender",
                "receiver",
                "trackingNumber"
            ]
        },
        "jurisdiction": {
            "type": "string",
            "enum": [
                "AL",
                "AK",
                "AZ",
                "AR",
                "CA",
                "CO",
                "CT",
                "DE",
                "DC",
                "FL",
                "GA",
                "GU",
                "HI",
                "ID",
                "IL",
                "IN",
                "IA",
                "KS",
                "KY",
                "LA",
                "ME",
                "MD",
                "MA",
                "MI",
                "MN",
                "MS",
                "MO",
                "MT",
                "NE",
                "NV",
                "NH",
                "NJ",
                "NM",
                "NY",
                "NC",
                "ND",
                "OH",
                "OK",
                "OR",
                "PA",
                "PR",
                "RI",
                "SC",
                "SD",
                "TN",
                "TX",
                "UT",
                "VT",
                "VI",
                "VA",
                "WA",
                "WV",
                "WI",
                "WY"
            ]
        },
        "courseInformation": {
            "type": "object",
            "description": "This object identifies the course details being reported on the defined financial professional.",
            "properties": {
                "provider": {
                    "type": "string",
                    "pattern": "(?i)^(AD BANKER|KAPLAN|LUMA|PINPOINT|QUESTCE|REGED|SUCCESSCE|ICAPITAL|SMARTPROS|WEBCE)$",
                    "description": "This is to identify the provider of this particular training."
                },
                "ID": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 20,
                    "description": "Unique identifier for the course."
                },
                "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 40,
                    "description": "Name of Course."
                },
                "method": {
                    "type": "string",
                    "pattern": "^(?i)(ONLINE|CLASSROOM|REFERENCE MATERIALS|WHOLESALER)$",
                    "description": "Method by which training was completed."
                },
                "type": {
                    "type": "string",
                    "pattern": "^(?i)(STATE|PRODUCT|BEST INTEREST|DISABILITY|LONG TERM CARE|RIDER|ETHICS|ANTI-MONEY LAUNDERING)$",
                    "description": "Type of course completed."
                },
                "originatingJurisdiction": {
                    "$ref": "#/$defs/jurisdiction",
                    "description": "Jurisdiction that completion applies to (for state training)."
                },
				"originatingJurisdictionCreditHours": {
                    "type": "number",
                    "description": "Training credit hours in originating jurisdiction",
                    "minimum": 1,
                    "maximum": 999
                },
                "reciprocityJurisdictionsList": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "jurisdiction": {
                                "$ref": "#/$defs/jurisdiction"
                            },
                            "creditHours": {
                                "type": "number",
                                "minimum": 1,
                                "maximum": 999
                            }
                        },
                        "required": ["jurisdiction"]
                    },
                    "minItems": 1,
                    "maxItems": 54,
                    "description": "List of jurisdictions and credit hours for reciprocity of the state training."
                },
                "cusip": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "minLength": 9,
                        "maxLength": 9,
                        "pattern": "(^[a-zA-Z0-9]{9}$)"
                    },
                    "minItems": 1,
                    "maxItems": 250,
                    "description": "CUSIP identifier for product that completion applies to (for product training)."
                },
                "productTrainingCategory": {
                    "type": "string",
                    "pattern": "^(?i)(Contingent Deferred Annuity|Deferred Income Annuity|Disability|Fixed Index Annuity|Fixed Annuity|Fixed Immediate Annuity|Index Variable Annuity|Fixed Universal Life|Fixed Whole Life|Long Term Care|Pension Plan|Retirement Plan|Term Life|Variable Annuity|Variable Immediate Annuity|Variable Universal Life|Variable Whole Life|Index Life|All Annuities|All Fixed Annuities|All Variable Annuities)$",
                    "description": "Type of product associated with product training."
                },
                "trainingCompletionDate": {
                    "type": "string",
                    "format": "date",
                    "description": "Date on which course was completed/verified."
                },
                "trainingExpirationDate": {
                    "type": "string",
                    "format": "date",
                    "description": "Date on which training will expire."
                }
            },
            "required": [
                "provider",
                "ID",
                "name",
                "type",
                "trainingCompletionDate"
            ],
            "propertyNames": {
                "enum": [
                    "provider",
                    "ID",
                    "name",
                    "method",
                    "type",
                    "originatingJurisdiction",
					"originatingJurisdictionCreditHours",
                    "reciprocityJurisdictionsList",
                    "cusip",
                    "productTrainingCategory",
                    "trainingCompletionDate",
                    "trainingExpirationDate"
                ]
            },
            "allOf": [
                {
                    "if": {
                        "properties": {
                            "type": {
                                "type": "string",
                                "pattern": "^(?i)(STATE|BEST INTEREST)$"
                            }
                        }
                    },
                    "then": {
                        "required": [
                            "originatingJurisdiction"
                        ]
                    }
                },
                {
                    "if": {
                        "not": {
                            "required": [
                                "cusip"
                            ]
                        }
                    },
                    "then": {
                        "required": [
                            "productTrainingCategory"
                        ]
                    }
                },
                {
                    "if": {
                        "properties": {
                            "type": {
                                "type": "string",
                                "pattern": "^(?i)PRODUCT$"
                            }
                        }
                    },
                    "then": {
                        "required": [
                            "cusip"
                        ]
                    }
                },
				{
				    "if": {
					    "not": {
					         "required": [
								"originatingJurisdiction"
							 ]
						}
					},
					"then": {
						"not": {
							"required": [
								"originatingJurisdictionCreditHours"
							]
						}
					}
				}
            ]
        }
    }
}